#!/bin/bash

# Aide
for arg in "$@"; do
    if [[ "$arg" == "-h" || "$arg" == "--help" ]]; then
        echo "Stop Docker container. Usage: $0 [container_name_or_dir]"
        exit 0
    fi
done

# Nom du conteneur (par défaut nom du dossier courant)
container_name="${1:-$(basename "$(pwd)")}"

# Stop + remove
docker stop "$container_name" 2>/dev/null || true
docker rm "$container_name" 2>/dev/null || true

# Si l'utilisateur donne un argument ET que c'est un dossier existant
if [[ -n "$1" && -d "$1" ]]; then
    echo "➡️  Dossier trouvé : $1 → lancement docker compose"
    (
        cd "$1" || exit 1
        docker compose up -d
    )
else
    # Pas de dossier ⇒ docker compose dans le dossier courant
    echo "➡️  Aucun dossier ou paramètre → docker compose dans le dossier courant"
    docker compose up -d
fi
